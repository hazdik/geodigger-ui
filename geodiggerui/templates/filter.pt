<div metal:use-macro="view.layout">
    <div metal:fill-slot="content">
        <div class="row">
            <h2>${title}</h2>
        </div>
        <div tal:condition="error">
            <div class="row alert alert-danger"><strong>Error:</strong> ${error}</div>
        </div>
        <form action="/filter" method="POST">
            <!-- Map placeholder -->
            <script src="http://cdn.leafletjs.com/leaflet-0.7.2/leaflet.js"></script>
            <div class="row form-group">
                <h3>
                    <small>
                        <span class="glyphicon glyphicon-globe"></span>
                    </small> Location
                </h3>
                <div class="col-md-4">
                    <textarea class="form-control" rows=15></textarea>
                    <br>
                    <button class="btn btn-primary" type="update"
                            name="update">Update Map
                    </button>
                </div>
                <div class="col-md-8">
                    <div id="map" style='height:450px'></div>
                    <script>
                    var map = L.map('map').setView([30,-10], 2);
                    L.tileLayer('http://otile{s}.mqcdn.com/tiles/1.0.0/map/{z}/{x}/{y}.png', {
                        maxZoom: 18,
                        subdomains: ['1', '2', '3', '4'],
                        attribution: 'Tiles Courtesy of <a href="http://www.mapquest.com/" target="_blank">MapQuest</a>. Map data (c) <a href="http://www.openstreetmap.org/" target="_blank">OpenStreetMap</a> contributors, CC-BY-SA.'
                    }).addTo(map);
                    </script>
                </div>
            </div>

            <!-- Date/time parameters -->
            <div class="row form-group">
                <h3>
                    <small>
                        <span class="glyphicon glyphicon-calendar"></span>
                    </small> Time Period
                </h3>

                <div id="slider"></div>
                <script src="${request.static_url('geodiggerui:static/jquery-ui.min.js')}"></script>
                <script src="${request.static_url('geodiggerui:static/jquery.mousewheel.min.js')}">
                </script>
                <script src="${request.static_url('geodiggerui:static/jQRangeSliderMouseTouch.js')}">
                </script>
                <script src="${request.static_url('geodiggerui:static/jQRangeSliderDraggable.js')}">
                </script>
                <script src="${request.static_url('geodiggerui:static/jQRangeSliderBar.js')}"></script>
                <script src="${request.static_url('geodiggerui:static/jQRangeSliderHandle.js')}"></script>
                <script src="${request.static_url('geodiggerui:static/jQRangeSliderLabel.js')}"></script>
                <script src="${request.static_url('geodiggerui:static/jQRangeSlider.js')}"></script>
                <script src="${request.static_url('geodiggerui:static/jQDateRangeSliderHandle.js')}">
                </script>
                <script src="${request.static_url('geodiggerui:static/jQDateRangeSlider.js')}"></script>
                <script src="${request.static_url('geodiggerui:static/jQRuler.js')}"></script>
                <script>
                    var months = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sept", "Oct", "Nov", "Dec"];
                    $(function(){
                            $("#slider").dateRangeSlider(${sliderOptions});
                    });//]]> 
                </script>

                <div class="row"><br></div>

                <div class="col-md-12">
                    <label class="row control-label">Period currently selected: XX weeks</label>
                    <div class="row">
                        <div class="col-md-6 input-group">
                            <span class="input-group-addon">From</span>
                            <input type="text" class="form-control" id="minDate"
                                   name="minDate" placeholder="">
                        </div>
                        <div class="col-md-6 input-group">
                            <span class="input-group-addon">To</span>
                            <input type="text" class="form-control" id="maxDate"
                                   name="maxDate" placeholder="">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Source -->
            <div class="row form-group">
                <h3>
                    <small>
                        <span class="glyphicon glyphicon-cloud"></span>
                    </small> Source
                </h3>
                <div tal:repeat="source sources">
                    <div class="checkbox">
                        <label>
                            <input type="checkbox" name="source_${source}"
                                   id="source_${source}" checked> ${source}
                        </label>
                    </div>
                </div>
            </div>

            <!-- Users -->
            <div class="row form-group">
                <h3>
                    <small>
                        <span class="glyphicon glyphicon-user"></span>
                    </small> Users
                </h3>
                <input type="text" class="form-control" id="users"
                       name="users" placeholder="Default: All users">
            </div>

            <!-- Download type -->
            <div class="row form-group">
                <h3>
                    <small>
                        <span class="glyphicon glyphicon-file"></span>
                    </small> Download type
                </h3>
                <div class="radio">
                    <label>
                        <input type="radio" name="downloadtype"
                               id="downloadtype1" value="CSV" checked> CSV
                    </label>
                </div>
                <div class="radio">
                    <label>
                        <input type="radio" name="downloadtype"
                               id="downloadtype2" value="JSON"> JSON
                    </label>
                </div>
            </div>

            <!-- Spacer -->
            <div class="row">
                <br><br>
            </div>

            <!-- Buttons -->
            <div class="row form-group">
                <button class="btn btn-primary" type="submit"
                        name="submit">Run Query
                </button>
            </div>
        </form>
    </div>
</div>
